---
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const allPosts = await getCollection('blog');
const tags = [...new Set(allPosts.map((post) => post.data.tags).flat())];
const tagCounts = tags.reduce((acc, tag) => {
    acc[tag] = allPosts.filter(p => p.data.tags.includes(tag)).length;
    return acc;
}, {} as Record<string, number>);

---

<Layout title="所有标签 | My Technical Blog" description="Browse content by tags">
    <div class="py-12 text-center">
        <h1 class="text-3xl font-bold tracking-tight text-zinc-900 dark:text-white mb-8">Tags</h1>
        <div class="flex flex-wrap justify-center gap-4 max-w-2xl mx-auto">
            {tags.map((tag) => (
                 <a href={`/my-blog/tags/${tag}`} class="inline-flex items-center gap-x-2 rounded-full px-4 py-2 text-sm font-medium text-zinc-900 ring-1 ring-inset ring-zinc-200 hover:bg-zinc-50 dark:text-zinc-200 dark:ring-zinc-700 dark:hover:bg-zinc-800 transition-colors">
                    <span>{tag}</span>
                    <span class="inline-flex items-center justify-center rounded-full bg-zinc-100 dark:bg-zinc-700 px-2 h-5 text-xs text-zinc-500 dark:text-zinc-300">
                        {tagCounts[tag]}
                    </span>
                 </a>
            ))}
        </div>
    </div>
</Layout>
